\begin{definition}[Syntactic Conventions]
  We use the following metavariables for all languages:
  \[
    \begin{array}{rcll}
      \odot  & \coloneqq & + \mid - \mid * & \emph{Arithmetic Operators}
    \end{array}
  \]
\end{definition}

\begin{definition}[Syntax of Fun]
  We assume a finite set of names $\mathcal{N}$ containing type names $T\in\mathcal{N}$, constructor names $K\in\mathcal{N}$ and destructor names $D\in\mathcal{N}$.
  \[ 
    \begin{array}{r c l l}
      t & \coloneqq & x \mid \lit{n} \mid t \odot t \mid \ifz{t}{t}{t} \mid \letin{x}{t}{t} \mid f(\overline{t}; \overline{\alpha}) & \emph{Terms}\\
      & \mid & K(\overline{t}) \mid \caseof{t}{\overline{K\ \Gamma \Rightarrow t}} \mid t.D(\overline{t}) \mid \cocase{\overline{D\ \Gamma \Rightarrow t}} & \\
      & \mid & \lab{\alpha}{t} \mid \goto{t}{\alpha} & \\
      \tau & \coloneqq & \tyint \mid T & \emph{Types} \\
      \kappa & \coloneq & \mathbf{data} \mid \mathbf{codata} \mid \mathbf{prim} & \emph{Kinds} \\
      \Gamma & \Coloneqq & \emptyset \mid \Gamma, x : \tau \mid \Gamma, \alpha \cnt \tau & \emph{Typing Contexts} \\
      \delta & \coloneqq & \mathbf{data}\ T\ \{ \overline{K\ \Gamma} \} & \emph{Data Type Definition}\\
       & \mid & \mathbf{codata}\ T\ \{ \overline{D\ \Gamma : \tau}\} & \emph{Codata Type Definition}\\
       & \mid & \defi{f\ \Gamma}{t} & \emph{Top-Level Definitions}\\
      \Theta & \coloneqq & \overline{\delta} & \emph{Programs}\\
    \end{array}
  \]
\end{definition}

%%
%% Subsec: Typing Rules
%%
\subsection{Typing Rules}
\label{subsec:fun:typing-rules}


\begin{minipage}{\textwidth}
\begin{minipage}{0.3\textwidth}
  \begin{prooftree}
    \AxiomC{$x : \tau \in \Gamma$}
    \RightLabel{\textsc{Var}}
    \UnaryInfC{$\Theta\mid\Gamma \vdash x : \tau$}
  \end{prooftree}
\end{minipage}
\hfill
\begin{minipage}{0.3\textwidth}
  \begin{prooftree}
    \AxiomC{\phantom{$x : \tau \in \Gamma$}}
    \RightLabel{\textsc{Lit}}
    \UnaryInfC{$\Theta\mid\Gamma \vdash \lit{n}:\tyint$}
  \end{prooftree}
\end{minipage}
\hfill
\begin{minipage}{0.3\textwidth}
  \begin{prooftree}
    \AxiomC{$\Theta\mid\Gamma \vdash t_1: \tyint \quad \Theta\mid\Gamma \vdash t_2: \tyint$}
    \RightLabel{\textsc{Op}}
    \UnaryInfC{$\Theta\mid\Gamma \vdash t_1\odot t_2 : \tyint$}
  \end{prooftree}
\end{minipage}
\hfill
\vspace{1em}

\begin{minipage}{0.55\textwidth}
  \begin{prooftree}
    \AxiomC{$\Theta\mid\Gamma \vdash t : \tyint$}
    \AxiomC{$\Theta\mid\Gamma \vdash t_1 : \tau$}
    \AxiomC{$\Theta\mid\Gamma \vdash t_2 : \tau$}
    \RightLabel{\textsc{Ifz}}
    \TrinaryInfC{$\Theta\mid\Gamma \vdash \ifz{t}{t_1}{t_2} : \tau$}
  \end{prooftree}
\end{minipage}
\hfill
\begin{minipage}{0.4\textwidth}
  \begin{prooftree}
    \AxiomC{$\Theta\mid\Gamma \vdash t_1 : \tau_1$}
    \AxiomC{$\Theta\mid\Gamma, x : \tau_1 \vdash t_2 : \tau_2$}
    \RightLabel{\textsc{Let}}
    \BinaryInfC{$\Theta\mid\Gamma \vdash \letin{x}{t_1}{t_2} :\tau_2$}
  \end{prooftree}
\end{minipage}
\hfill
\vspace{1em}

\begin{minipage}{\textwidth}
  \begin{prooftree}
    \AxiomC{$\mathbf{def}\ f\ \Gamma^{\prime} :\tau \in \Theta$}
    \AxiomC{$\Theta\mid\Gamma \vdash \sigma:\Gamma^{\prime} $}
    \RightLabel{\textsc{Call}}
    \BinaryInfC{$\Theta\mid\Gamma \vdash f\ \sigma : \tau$}
  \end{prooftree}
\end{minipage}
\hfill
\vspace{1em}

\begin{minipage}{0.55\textwidth}
  \begin{prooftree}
    \AxiomC{$\Theta\mid\Gamma \vdash t : \tau$}
    \AxiomC{$\alpha \cnt \tau \in \Gamma$}
    \RightLabel{\textsc{Goto}}
    \BinaryInfC{$\Theta\mid\Gamma \vdash \goto{t}{\alpha} : \tau'$}
  \end{prooftree}
\end{minipage}
\begin{minipage}{0.4\textwidth}
  \begin{prooftree}
    \AxiomC{$\Theta\mid\Gamma, \alpha \cnt \tau \vdash t : \tau$}
    \RightLabel{\textsc{Label}}
    \UnaryInfC{$\Theta\mid\Gamma \vdash \lab{\alpha}{t} : \tau$}
  \end{prooftree}
\end{minipage}
\hfill
\vspace{1em}
\begin{minipage}{\textwidth}
  \begin{prooftree}
    \AxiomC{$\mathbf{data}\ T\ \{\ldots, K\ \Gamma^{\prime}\}\in\Theta$}
    \AxiomC{$ \Theta\mid\Gamma \vdash \sigma:\Gamma^{\prime}$}
    \RightLabel{\textsc{Constructor}}
    \BinaryInfC{$\Theta\mid\Gamma \vdash K\ \sigma : T$}
  \end{prooftree}
\end{minipage}
\hfill
\vspace{1em}
\begin{minipage}{\textwidth}
  \begin{prooftree}
    \AxiomC{$\mathbf{data}\ T\{\overline{K_i\ \Gamma_i)}\}\in \Theta$}
    \AxiomC{$\overline{\Theta\mid\Gamma,\Gamma_i\vdash t_i : \tau}$}
    \RightLabel{\textsc{Case}}
    \BinaryInfC{$\Theta\mid\Gamma\vdash \mathbf{case}\ t\ \mathbf{of}\ \{\overline{K_i\ \Gamma_i\Rightarrow t_i}\} : \tau$}
  \end{prooftree}
\end{minipage}
\hfill
\vspace{1em}
\begin{minipage}{\textwidth}
  \begin{prooftree}
    \AxiomC{$\mathbf{codata}\ T\ \{\dots, D\ \Gamma^{\prime}:\tau\}\in \Theta$}
    \AxiomC{$\Theta\mid\Gamma\vdash \sigma:\Gamma^{\prime}$}
    \AxiomC{$\Theta\mid\Gamma \vdash t :T$}
    \RightLabel{\textsc{Destructor}}
    \TrinaryInfC{$\Theta\mid\Gamma \vdash t.D\ \sigma : \tau$}
  \end{prooftree}
\end{minipage}
\begin{minipage}{\textwidth}
  \begin{prooftree}
    \AxiomC{$\mathbf{codata}\ T \{\overline{D_i\ \Gamma_i:\tau_i}\}\in \Theta$}
    \AxiomC{$\Theta\mid\Gamma,\Gamma_i \vdash t_i:\tau_i$}
    \RightLabel{\textsc{Cocase}}
    \BinaryInfC{$\Theta\mid\Gamma \vdash \mathbf{cocase} \{ \overline{D_i\ \Gamma_i} \Rightarrow t_i \} : T$}
  \end{prooftree}
\end{minipage}

\hfill
  \vspace{1.5em}
  \rule{\textwidth}{0.4pt}
  \par
  \vspace{1em}
  \begin{minipage}{0.25\textwidth}
    \begin{prooftree}
      \AxiomC{}
      \RightLabel{\textsc{Wf-Empty}}
      \UnaryInfC{$\vdash \wellformed{\emptyset}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \begin{minipage}{0.7\textwidth}
    \begin{prooftree}
      \AxiomC{$\vdash \wellformed{\Theta}$}
      \AxiomC{$\Theta, \mathbf{def}\ \text{f}\ \Gamma\coloneq t \mid\Gamma \vdash t:\tau$}
      \RightLabel{\textsc{Wf-Fun}}
      \BinaryInfC{$\vdash \wellformed{\Theta,\mathbf{def}\ \text{f}\ \Gamma \coloneq t}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \vspace{1em}
  \begin{minipage}{\textwidth}
    \begin{prooftree}
      \AxiomC{$\vdash \wellformed{\Theta}$}
      \AxiomC{$\overline{K},T$ do not occur in $\Theta$}
      \AxiomC{$\overline{\wellformed{\Gamma_i}}$}
      \RightLabel{\textsc{Wf-Data}}
      \TrinaryInfC{$\vdash \wellformed{\Theta,\mathbf{data}\ T\ \{ \overline{K_i\ \Gamma_i} \}}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \vspace{1em}
  \begin{minipage}{\textwidth}
    \begin{prooftree}
      \AxiomC{$\vdash \wellformed{\Theta}$}
      \AxiomC{$\overline{D},T$ do not occur in $\Theta$}
      \AxiomC{$\overline{\wellformed{\Gamma_i}}$}
      \AxiomC{$\overline{ \Gamma_i \vdash \tau_i:\kappa}$}
      \RightLabel{\textsc{Wf-Codata}}
      \QuaternaryInfC{$\vdash \wellformed{\mathbf{codata}\ T\ \{ \overline{D_i\ \Gamma_i : \tau_i}\}}$}
    \end{prooftree}
  \end{minipage}
\end{minipage}
\vspace{1em}

\begin{minipage}{0.3\textwidth}
  \begin{prooftree}
    \AxiomC{}
    \RightLabel{\textsc{PrimKind}}
    \UnaryInfC{$\Theta \vdash \tyint : \mathbf{prim}$}
  \end{prooftree}  
\end{minipage}
\begin{minipage}{0.3\textwidth}
  \begin{prooftree}
    \AxiomC{$\mathbf{data}\ T\ \{\, \ldots \} \in \Theta$}
    \RightLabel{\textsc{DataKind}}
    \UnaryInfC{$\Theta \vdash T : \mathbf{data}$}
  \end{prooftree}  
\end{minipage}
\begin{minipage}{0.3\textwidth}
  \begin{prooftree}
    \AxiomC{$\mathbf{codata}\ T\ \{\, \ldots \} \in \Theta$}
    \RightLabel{\textsc{CodataKind}}
    \UnaryInfC{$\Theta \vdash T : \mathbf{codata}$}
  \end{prooftree}  
\end{minipage}






