\begin{definition}[Syntactic Conventions]
  We use the following metavariables for all languages:
  \[
    \begin{array}{rcll}
      \odot  & \coloneqq & + \mid - \mid * & \emph{Arithmetic Operators}
    \end{array}
  \]
\end{definition}

\begin{definition}[Syntax of Fun]
  We assume a finite set of names $\mathcal{N}$ containing type names $T\in\mathcal{N}$, constructor names $K\in\mathcal{N}$ and destructor names $D\in\mathcal{N}$.
  \[ 
    \begin{array}{r c l l}
      t & \coloneqq & x \mid \lit{n} \mid t \odot t \mid \ifz{t}{t}{t} \mid \letin{x}{t}{t} \mid f(\overline{t}; \overline{\alpha}) & \emph{Terms}\\
      & \mid & K(\overline{t}) \mid \caseof{t}{\overline{K(\overline{x}) \Rightarrow t}} \mid t.D(\overline{t}) \mid \cocase{\overline{D(\overline{x}) \Rightarrow t}} & \\
      & \mid & \lambda x.t \mid t\ t \mid \lab{\alpha}{t} \mid \goto{t}{\alpha} & \\
      \Sigma & \coloneqq & \mathbf{data}\ T\ \{ \overline{K(\overline{x:\tau};\overline{\alpha:\tau})} \} \mid \mathbf{codata}\ T\ \{ \overline{D(\overline{x:\tau};\overline{\alpha:\tau})}\} & \emph{Type Definitions}\\
      F & \coloneqq & \defi{f(\overline{x};\overline{\alpha})}{t} & \emph{Top-Level Definitions}\\
      \Theta & \coloneqq & \overline{\Sigma};\overline{F} & \emph{Programs}\\
    \end{array}
  \]
\end{definition}

%%
%% Subsec: Typing Rules
%%
\subsection{Typing Rules}
\label{subsec:fun:typing-rules}

\begin{definition}[Types and Typing Contexts]
\[
  \begin{array}{l c l r}
    \tau   & \Coloneqq & \tyint \mid T & \emph{Types}\\
    \Gamma & \Coloneqq & \emptyset \mid \Gamma, x \prd \tau \mid \Gamma, \alpha \cnt \tau \mid \Gamma, \Sigma& \emph{Typing Contexts}
  \end{array}
\]
\end{definition}

\begin{minipage}{\textwidth}
\begin{minipage}{0.3\textwidth}
  \begin{prooftree}
    \AxiomC{$x \prd \tau \in \Gamma$}
    \RightLabel{\textsc{Var}}
    \UnaryInfC{$\Gamma \vdash x : \tau$}
  \end{prooftree}
\end{minipage}
\hfill
\begin{minipage}{0.3\textwidth}
  \begin{prooftree}
    \AxiomC{\phantom{$x : \tau \in \Gamma$}}
    \RightLabel{\textsc{Lit}}
    \UnaryInfC{$\Gamma \vdash \lit{n}:\tyint$}
  \end{prooftree}
\end{minipage}
\hfill
\begin{minipage}{0.3\textwidth}
  \begin{prooftree}
    \AxiomC{$\Gamma \vdash t_1: \tyint \quad \Gamma \vdash t_2: \tyint$}
    \RightLabel{\textsc{Op}}
    \UnaryInfC{$\Gamma \vdash t_1\odot t_2 : \tyint$}
  \end{prooftree}
\end{minipage}
\hfill
\vspace{1em}

\begin{minipage}{0.55\textwidth}
  \begin{prooftree}
    \AxiomC{$\Gamma \vdash n : \tyint$}
    \AxiomC{$\Gamma \vdash t_1 : \tau$}
    \AxiomC{$\Gamma \vdash t_2 : \tau$}
    \RightLabel{\textsc{Ifz}}
    \TrinaryInfC{$\Gamma \vdash \ifz{n}{t_1}{t_2} : \tau$}
  \end{prooftree}
\end{minipage}
\hfill
\begin{minipage}{0.4\textwidth}
  \begin{prooftree}
    \AxiomC{$\Gamma \vdash t_1 : \tau_1$}
    \AxiomC{$\Gamma, x \prd \tau_1 \vdash t_2 : \tau_2$}
    \RightLabel{\textsc{Let}}
    \BinaryInfC{$\Gamma \vdash \letin{x}{t_1}{t_2} :\tau_2$}
  \end{prooftree}
\end{minipage}
\hfill
\vspace{1em}

\begin{minipage}{\textwidth}
  \begin{prooftree}
    \AxiomC{$\mathbf{def}\ f(\overline{x_i \prd \tau_i};\overline{\alpha_j\cnt\tau_j}) :\tau \in P$}
    \AxiomC{$\overline{\Gamma \vdash t_i : \tau_i}$}
    \AxiomC{$\overline{\beta_j \cnt \tau_j \in \Gamma}$}
    \RightLabel{\textsc{Call}}
    \TrinaryInfC{$\Gamma \vdash f(\overline{t_i};\overline{\beta_j}) : \tau$}
  \end{prooftree}
\end{minipage}
\hfill
\vspace{1em}

\begin{minipage}{0.55\textwidth}
  \begin{prooftree}
    \AxiomC{$\Gamma \vdash t : \tau$}
    \AxiomC{$\alpha \cnt \tau \in \Gamma$}
    \RightLabel{\textsc{Goto}}
    \BinaryInfC{$\Gamma \vdash \goto{t}{\alpha} : \tau'$}
  \end{prooftree}
\end{minipage}
\begin{minipage}{0.4\textwidth}
  \begin{prooftree}
    \AxiomC{$\Gamma, \alpha \cnt \tau \vdash t : \tau$}
    \RightLabel{\textsc{Label}}
    \UnaryInfC{$\Gamma \vdash \lab{\alpha}{t} : \tau$}
  \end{prooftree}
\end{minipage}
\hfill
\vspace{1em}
\begin{minipage}{\textwidth}
  \begin{prooftree}
    \AxiomC{$\mathbf{data}\ T\ \{\ldots, K(\overline{x_i:\tau_i};\overline{\alpha_j:\tau_j})\}\in\Gamma$}
    \AxiomC{$\overline{\beta_j\cnt\tau_j\in\Gamma}$}
    \AxiomC{$\overline{\Gamma \vdash t_i\prd \tau_i}$}
    \RightLabel{\textsc{Constructor}}
    \TrinaryInfC{$\Gamma \vdash K(\overline{t_i};\overline{\beta_j})) : T$}
  \end{prooftree}
\end{minipage}
\hfill
\vspace{1em}
\begin{minipage}{\textwidth}
  \begin{prooftree}
    \AxiomC{$\mathbf{data}\ T\{\overline{K_i(\overline{x_{i,j}:\tau_{i,j}};\overline{\alpha_{i,k}:\tau_{i,k}}))}\}\in\Gamma$}
    \AxiomC{$\overline{\Gamma,\overline{x_{i,j}\prd\tau_{i,j}},\overline{\alpha_{i,k}\cnt \tau_{i,k}} \vdash t_i\prd \tau}$}
    \RightLabel{\textsc{Case}}
    \BinaryInfC{$\Gamma\vdash \mathbf{case}\ t\ \mathbf{of}\ \{\overline{K_i(x_{i,j};\alpha_{i,k})\Rightarrow t_i}\} : \tau$}
  \end{prooftree}
\end{minipage}
\hfill
\vspace{1em}
\begin{minipage}{\textwidth}
  \begin{prooftree}
    \AxiomC{$\mathbf{codata}\ T\ \{\dots, D(\overline{x_i:\tau_i}, \overline{\alpha_j:\tau_j})\}\in\Gamma$}
    \AxiomC{$\overline{\Gamma\vdash t_i\prd \tau_i}$}
    \AxiomC{$\overline{\alpha_j\cnt\tau_j\in\Gamma}$}
    \AxiomC{$\Gamma \vdash t :T$}
    \RightLabel{\textsc{Destructor}}
    \QuaternaryInfC{$\Gamma \vdash t.D(\overline{t_i};\overline{\alpha_j}) : \tau$}
  \end{prooftree}
\end{minipage}
\begin{minipage}{\textwidth}
  \begin{prooftree}
    \AxiomC{$\mathbf{codata}\ T \{\overline{D_i(\overline{x_{i,j}:\tau_{i,j}};\overline{\alpha_{i,k}:\tau_{i,k}})}\}\in\Gamma$}
    \AxiomC{$\Gamma,\overline{y_{i,j}\prd\tau_{i,j}},\overline{\beta_{i,k}\cnt\tau_{i,k}} \vdash t_i:\tau$}
    \RightLabel{\textsc{Cocase}}
    \BinaryInfC{$\Gamma \vdash \mathbf{cocase} \{ \overline{D_i(\overline{y_{i,j}};\overline{\beta_{i,k}})} \Rightarrow t_i \} : T$}
  \end{prooftree}
\end{minipage}
\end{minipage}

