This is a generalization of the focusing transformation which names all subterms instead of only non-value producers.
It targets the following fragment \targetvar{} of \targetlang{} where arguments are always (co-)variables

\begin{definition}[Syntax of \targetvar{}]
  \[
    \begin{array}{rcll}
      p & \coloneqq & x \mid \lit{n} \mid \mu\alpha.s \mid K\ \Gamma \mid \cocase{\overline{D\ \Gamma \Rightarrow s}} & \emph{Producers}\\
      c & \coloneqq & \alpha \mid \tilde{\mu}x.s \mid D\ \Gamma \mid \case{\overline{K\ \Gamma \Rightarrow s}}& \emph{Consumers}\\
      s & \coloneqq & \cut{p}{c} \mid \ifz{x}{s}{s} \mid \odot(x, x; \alpha) \mid f\ \Gamma \mid \done & \emph{Statements}\\
    \end{array}
  \]
\end{definition}


The cases for constructors and destructors are special-cased to avoid administrative redexes.

\[
  \begin{array}{rcll}
    \\
    \multicolumn{4}{c}{\name{\cdot} : \emph{Definition}_{\targetlang{}} \rightarrow \emph{Definition}_{\targetvar{}}}\\
    \name{\defi{f\ \Gamma}{s}} & \coloneq & \defi{f\ \Gamma}{\name{s}} & \\
    \\
    \multicolumn{4}{c}{\name{\cdot} : \emph{Statement}_{\targetlang{}} \rightarrow \emph{Statement}_{\targetvar{}}}\\
    \name{\cut{K\ \sigma}{c}} & \coloneq & \binds{\sigma}{\lambda as.\cut{K(as)}{\name{c}}} & \\
    \name{\cut{p}{D\ \sigma}} & \coloneq & \binds{\sigma}{\lambda as.\cut{\name{p}}{D(as)}} & \\
    \name{\cut{p}{c}} & \coloneq & \cut{\name{p}}{\name{c}} & \\
    \name{\odot(p_1, p_2; c)}{} & \coloneq & \bind{p_1}{\lambda a_1.\bind{p_2}{\lambda a_2.\odot(a_1, a_2; c)}} & \\
    \name{\ifz{p}{s_1}{s_2}}{} & \coloneq & \bind{p}{\lambda a.\ifz{a}{\name{s_1}}{\name{s_2}}} & \\
    \name{f\ \sigma}{} & \coloneq & \binds{\sigma}{\lambda as.f(as)} & \\
    \name{\done}{} & \coloneq & \done & \\
    \\
    \multicolumn{4}{c}{\name{\cdot} : \emph{Producer}_{\targetlang{}} \rightarrow \emph{Producer}_{\targetvar{}}}\\
    \name{x} & \coloneq & x & \\
    \name{\lit{n}} & \coloneq & \lit{n} & \\
    \name{\mu\alpha.s} & \coloneq & \mu\alpha.\name{s} & \\
    \name{K\ \sigma} & \coloneq & \mu\alpha.\binds{\sigma}{\lambda as.\cut{K(as)}{\alpha}} & \fresh{\alpha} \\
    \name{\cocase{\overline{D_i\ \Gamma_i \Rightarrow s_i}}} & \coloneq & \cocase{\overline{D_i\ \Gamma_i \Rightarrow \name{s_i}}} & \\
    \\
    \multicolumn{4}{c}{\name{\cdot} : \emph{Consumer}_{\targetlang{}} \rightarrow \emph{Consumer}_{\targetvar{}}}\\
    \name{\alpha} & \coloneq & \alpha & \\
    \name{\tilde{\mu}x.s} & \coloneq & \tilde{\mu}x.\name{s} & \\
    \name{D\ \sigma} & \coloneq & \tilde{\mu}x.\binds{\sigma}{\lambda as.\cut{x}{D(as)}} & \fresh{x} \\
    \name{\case{\overline{K_i\ \Gamma_i \Rightarrow s_i}}} & \coloneq & \case{\overline{K_i\ \Gamma_i \Rightarrow \name{s_i}}} & \\
  \end{array}
\]

\[
  \begin{array}{rcll}
    \multicolumn{4}{c}{\bind{\cdot}{\cdot} : \emph{Producer}_{\targetlang{}} \times (\emph{Name} \rightarrow \emph{Statement}_{\targetvar{}}) \rightarrow \emph{Statement}_{\targetvar{}}}\\
    \bind{x}{k} & \coloneq & k(x) & \\
    \bind{\lit{n}}{k} & \coloneq & \cut{\lit{n}}{\tilde{\mu}x.k(x)} & \fresh{x} \\
    \bind{\mu\alpha.s}{k} & \coloneq & \cut{\mu\alpha.\name{s}}{\tilde{\mu}x.k(x)} & \fresh{x} \\
    \bind{K\ \sigma}{k} & \coloneq & \binds{\sigma}{\lambda as.\cut{K(as)}{\tilde{\mu}x.k(x)}} & \fresh{x} \\
    \bind{\cocase{\overline{D_i\ \Gamma_i \Rightarrow s_i}}}{k} & \coloneq & \cut{\cocase{\overline{D_i\ \Gamma_i \Rightarrow \name{s_i}}}}{\tilde{\mu}x.k(x)} & \fresh{x} \\
    \\
    \multicolumn{4}{c}{\bind{\cdot}{\cdot} : \emph{Consumer}_{\targetlang{}} \times (\emph{Name} \rightarrow \emph{Statement}_{\targetvar{}}) \rightarrow \emph{Statement}_{\targetvar{}}}\\
    \bind{\alpha}{k} & \coloneq & k(\alpha) & \\
    \bind{\tilde{\mu}x.s}{k} & \coloneq & \cut{\mu\alpha.k(\alpha)}{\tilde{\mu}x.\name{s}} & \fresh{\alpha} \\
    \bind{D\ \sigma}{k} & \coloneq & \binds{\sigma}{\lambda as.\cut{\mu\alpha.k(\alpha)}{D(as)}} & \fresh{\alpha} \\
    \bind{\case{\overline{K_i\ \Gamma_i \Rightarrow s_i}}}{k} & \coloneq & \cut{\mu\alpha.k(\alpha)}{\case{\overline{K_i\ \Gamma_i \Rightarrow \name{s_i}}}} & \fresh{\alpha} \\
    \\
    \multicolumn{4}{c}{\binds{\cdot}{\cdot} : \emph{Substitution} \times (\emph{List Name} \rightarrow \emph{Statement}_{\targetvar{}}) \rightarrow \emph{Statement}_{\targetvar{}}}\\
    \binds{\nil}{k} & \coloneq & k(\nil) & \\
    \binds{e :: es}{k} & \coloneq & \bind{e}{\lambda a.\binds{es}{\lambda as.k(a :: as)}} & \\
  \end{array}
\]
