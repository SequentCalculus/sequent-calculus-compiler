In this section we show how to translate terms of the surface language \surfacelang\ to producers of the intermediate language \targetlang.
We first introduce a simpler translation $\translate{\cdot}$ in \cref{subsec:translation:naive} which is straightforward but introduces administrative redexes.
We then introduce the optimized translation $\translatestar{\cdot}{}$ in \cref{subsec:translation:optimized} whis is more complicated, but which does not generate 
any additional administrative redexes.
We finish in \cref{subsec:translation:properties} by proving some core properties of these translation functions.

%%
%% Subsection: Naive Translation
%%
\subsection{Naive Translation}
\label{subsec:translation:naive}

\[
  \begin{array}{rcll}
    \multicolumn{4}{c}{\translate{\cdot} : \emph{Terms} \rightarrow \emph{Producers}}\\
    \\
    \translate{\defi{f(\overline{x}; \overline{\alpha})}{t}} & \coloneq & \defi{f(\overline{x}; \overline{\alpha}, \alpha)}{\cut{\translate{t}}{\alpha}} & \fresh{\alpha}\\
  \quad \\
    \translate{\lit{x}} & \coloneq & \lit{x} & \\
    \translate{\lit{n}} & \coloneq & \lit{n} & \\
    \translate{t_1 \odot t_2} & \coloneq & \mu\alpha.\odot(\translate{t_1}, \translate{t_2}; \alpha) & \fresh{\alpha}\\
    \translate{\ifz{t_1}{t_2}{t_3}} & \coloneq & \mu\alpha.\ifz{\translate{t_1}}{\cut{\translate{t_2}}{\alpha}}{\cut{\translate{t_3}}{\alpha}} & \fresh{\alpha}\\
    \translate{\letin{x}{t_1}{t_2}} & \coloneq & \mu\alpha.\cut{\translate{t_1}}{\tilde{\mu}x.\cut{\translate{t_2}}{\alpha}} & \fresh{\alpha}\\
    \translate{f(\overline{t_i}; \overline{\alpha_j})} & \coloneq & \mu\alpha.f(\overline{\translate{t_i}}; \overline{\alpha_j},\alpha) & \fresh{\alpha}\\
    \translate{K(\overline{t_i})} & \coloneq & K(\overline{\translate{t_i}}) & \\
    \translate{\caseof{t}{\overline{K_i(\overline{x_{i,j}}) \Rightarrow t_i}}} & \coloneq & \mu\alpha.\cut{\translate{t}}{\case{\overline{K_i(\overline{x_{i,j}}) \Rightarrow \cut{\translate{t_i}}{\alpha}}}} & \fresh{\alpha}\\
    \translate{t.D(\overline{t_i})} & \coloneq & \mu\alpha.\cut{\translate{t}}{D(\overline{\translate{t_i}}; \alpha)} & \fresh{\alpha}\\
    \translate{\cocase{\overline{D_i(\overline{x_{ij}})\Rightarrow t_i}}} & \coloneq & \cocase{\overline{D_i(\overline{x_{i,j}}; \alpha_i) \Rightarrow \cut{\translate{t_i}}{\alpha_i}}} & \fresh{\overline{\alpha_i}}\\
    \translate{\lambda x.t} & \coloneq & \cocase{\mathtt{ap}(x; \alpha) \Rightarrow \cut{\translate{t}}{\alpha}} & \fresh{\alpha}\\
    \translate{t_1\ t_2} & \coloneq & \mu\alpha.\cut{\translate{t_1}}{\mathtt{ap}(\translate{t_2}; \alpha)} & \fresh{\alpha}\\
    \translate{\lab{\alpha}{t}} & \coloneq & \mu\alpha.\cut{\translate{t}}{\alpha} & \\
    \translate{\goto{t}{\alpha}} & \coloneq & \mu\beta.\cut{\translate{t}}{\alpha} & \fresh{\beta}
  \end{array}
\]

%%
%% Subsection: Optimized Translation
%%
\subsection{Optimized Translation}
\label{subsec:translation:optimized}
We now introduce the optimized version of the translation introduced above.
This optimization works by splitting the function $\translate{\cdot}$ into the two functions $\translatestar{\cdot}{}$ and $\translatestar{\cdot}{k}$.
The intuition is that $\translatestar{p}{k}$ should be the same as $\cut{\translate{p}}{k}$, but whenever this results in a redex, for example if $\translate{p}$ has the form $\mu \alpha.s$, we reduce this administrative redex during the translation itself.

\[
  \begin{array}{rcll}
    \multicolumn{4}{c}{\translatestar{\cdot}{} : \emph{Term} \rightarrow  \emph{Producer}}\\
    \translatestar{t}{} & \coloneqq & \mu\alpha.\translatestar{t}{\alpha} & \fresh{\alpha}\\
    \\
    \multicolumn{4}{c}{\translatestar{\cdot}{\cdot} : \emph{Term} \times \emph{Consumer} \rightarrow \emph{Statement}}\\
    \translatestar{x}{c} & \coloneq & \cut{x}{c} & \\
    \translatestar{\lit{n}}{c} & \coloneq & \cut{\lit{n}}{c} & \\
    \translatestar{t_1 \odot t_2}{c} & \coloneq & \odot(\translatestar{t_1}{}, \translatestar{t_2}{}; c) & \\
    \translatestar{\ifz{t_1}{t_2}{t_2}}{c} & \coloneq & \ifz{\translatestar{t_1}{}}{\translatestar{t_2}{c}}{\translatestar{t_3}{c}} & \\
    \translatestar{\letin{x}{t_1}{t_2}}{c} & \coloneq & \translatestar{t_1}{\tilde{\mu}x.\translatestar{t_2}{c}} & \\
    \translatestar{f(\overline{t_i}; \overline{\alpha_j})}{c} & \coloneq & f(\overline{\translatestar{t_i}{}}; \overline{\alpha_j}, c) & \\
    \translatestar{K(\overline{t_i})}{c} & \coloneq & \cut{K(\overline{\translatestar{t_i}{}})}{c} & \\
    \translatestar{\caseof{t}{\overline{K_i(\overline{x_{i,j}}) \Rightarrow t_i}}}{c} & \coloneq & \translatestar{t}{\case{\overline{K_i(\overline{x_{i,j}}) \Rightarrow \translatestar{t_i}{c}}}} & \\
    \translatestar{t.D(\overline{t_i})}{c} & \coloneq & \translatestar{t}{D(\overline{\translatestar{t_i}{}}; c)} & \\
    \translatestar{\cocase{\overline{D_i(\overline{x_{i,j}}) \Rightarrow t_i}}}{c} & \coloneq & \cut{\cocase{\overline{D_i(\overline{x_{i,j}}; \alpha_i) \Rightarrow \translatestar{t_i}{\alpha_i}}}}{c} & \fresh{\overline{\alpha_i}} \\
    \translatestar{\lambda x.t}{c} & \coloneq & \cut{\cocase{\mathtt{ap}(x; \alpha) \Rightarrow \translatestar{t}{\alpha}}}{c} & \fresh{\alpha} \\
    \translatestar{t_1\ t_2}{c} & \coloneq & \translatestar{t_1}{\mathtt{ap}(\translatestar{t_2}{}; c)} & \\
    \translatestar{\lab{\alpha}{t}}{c} & \coloneq & \cut{\mu \alpha.\translatestar{t}{\alpha}}{c} & \\
    \translatestar{\goto{t}{\alpha}}{c} & \coloneq & \translatestar{t}{\alpha} & \\
    \\
    \multicolumn{4}{c}{\translatestar{\cdot}{} : \emph{Definition} \rightarrow \emph{Definition}}\\
    \translatestar{\defi{f(\overline{x}; \overline{\alpha})}{t}}{} & \coloneq & \defi{f(\overline{x}; \overline{\alpha}, \alpha)}{\translatestar{t}{\alpha}} & \fresh{\alpha}
  \end{array}
\]

%%
%% Section Properties
%%
\subsection{Properties}
\label{subsec:translation:properties}

\begin{lemma}
  If $\Gamma \vdash t : \tau$ and $\Gamma' \vdash k \cnt \tau$, then $\Gamma' \vdash \translatestar{t}{k}$.
\end{lemma}
\begin{proof}
  TODO: Figure out correct statement w.r.t. $\Gamma$ and $\Gamma'$.
\end{proof}

\begin{theorem}[Type Preservation]
  Let $t$ be a term in \surfacelang, and let $\tau$ be a type.
  If $\Gamma \vdash t: \tau$, then both $\Gamma \vdash \translate{t} \prd \tau$ and $\Gamma \vdash \translatestar{t}{} \prd \tau$.
\end{theorem}

\begin{theorem}[Correctness]
  Let $t$ be a term in \surfacelang. Then there are a finite number of reduction steps (where reduction here also means reduction under binders) such that $\focus{\translate{t}} \reducesto^{\ast} \focus{\translatestar{t}{}}$, where $\focus{\cdot}$ is the focusing translation.
\end{theorem}
