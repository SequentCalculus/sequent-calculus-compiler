
\begin{definition}[Syntax of AxCut]
    \[ 
      \begin{array}{r c l l}
        s & \coloneqq & \done  \mid \jump{f} \mid \substitute{\Gamma \mapsto \Gamma}{s} \mid \litac{n}{v}{s} \mid \opac{v, v}{v}{s} \mid \ifzac{v}{s}{s} & \emph{Statements}\\
        & \mid & \letac{v}{m\ \Gamma}{s} \mid \switch{v}{b} \mid \new{v}{\Gamma\ b}{s} \mid \invoke{v}{m} & \\
        b & \coloneqq & \bra{\overline{m\ \Gamma}} & \emph{Branches}\\
        v & \coloneqq & x \mid \alpha \mid j \mid \ldots & \emph{Variables}\\
        \tau & \coloneqq & \tyint \mid T & \emph{Types}\\
        \kappa & \coloneqq & \mathbf{sign} \mid \mathbf{prim} & \emph{Kinds}\\
        \Gamma & \coloneqq & \emptyset \mid \Gamma, v : \tau \mid \Gamma, v \cnt \tau \mid v \ext \tau & \emph{Typing Contexts} \\
        \delta & \coloneqq & \sig{T}{\overline{m\ \Gamma \Rightarrow s}} \mid \defi{f : \Gamma}{s} & \emph{Declarations}\\
        \Theta & \coloneqq & \overline{\delta} & \emph{Programs}\\
      \end{array}
    \]
\end{definition}

%%
%% Subsec: Typing Rules
%%
\subsection{Typing Rules}
\label{subsec:axcut:typing-rules}

\begin{figure}[hbtp]
  \begin{minipage}{\textwidth}
  \vspace{1em}
  \judgementbox{Typing Statements}{$\Theta\mid\Gamma\vdash s$}

  \begin{minipage}{0.45\textwidth}
    \begin{prooftree}
      \AxiomC{$\Theta \mid \Gamma, v \ext \tyint \vdash s$}
      \RightLabel{\textsc{Op}}
      \UnaryInfC{$\Theta \mid \Gamma \vdash \litac{n}{v}{s}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \begin{minipage}{0.45\textwidth}
    \begin{prooftree}
      \AxiomC{$v_1 \ext \tyint \in \Gamma$}
      \AxiomC{$v_2 \ext \tyint \in \Gamma$}
      \AxiomC{$\Theta \mid \Gamma, v \ext \tyint \vdash s$}
      \RightLabel{\textsc{Op}}
      \TrinaryInfC{$\Theta \mid \Gamma \vdash \opac{v_1, v_2}{v}{s}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \vspace{1em}

  \begin{minipage}{0.90\textwidth}
    \begin{prooftree}
      \AxiomC{$v \ext \tyint \in \Gamma$}
      \AxiomC{$\Theta \mid \Gamma \vdash s_1$}
      \AxiomC{$\Theta \mid \Gamma \vdash s_2$}
      \RightLabel{\textsc{Ifz}}
      \TrinaryInfC{$\Theta \mid \Gamma \vdash \ifzac{v}{s_1}{s_2}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \vspace{1em}

  \begin{minipage}{0.90\textwidth}
    \begin{prooftree}
      \AxiomC{$\sig{T}{{\ldots, m\ \Gamma_0, \ldots}} \in \Theta$}
      \AxiomC{$\Theta \mid \Gamma, v : T \vdash s$}
      \RightLabel{\textsc{Let}}
      \BinaryInfC{$\Theta \mid \Gamma, \Gamma_0 \vdash \letac{v}{m\ \Gamma_0}{s}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \vspace{1em}

  \begin{minipage}{0.90\textwidth}
    \begin{prooftree}
      \AxiomC{$\sig{T}{{\overline{m_i\ \Gamma_i}}} \in \Theta$}
      \AxiomC{$\overline{\Theta \mid \Gamma_i, \Gamma_0 \vdash s_i}$}
      \AxiomC{$\Theta \mid \Gamma, v \cnt T \vdash s$}
      \RightLabel{\textsc{New}}
      \TrinaryInfC{$\Theta \mid \Gamma, \Gamma_0 \vdash \new{v}{(\Gamma_0)\bra{\overline{m_i\ \Gamma_i \Rightarrow s_i}}}{s}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \vspace{1em}

  \begin{minipage}{0.45\textwidth}
    \begin{prooftree}
      \AxiomC{$\sig{T}{\overline{m_i\ \Gamma_i}} \in \Theta$}
      \AxiomC{$\overline{\Theta \mid \Gamma, \Gamma_i \vdash s_i}$}
      \RightLabel{\textsc{Switch}}
      \BinaryInfC{$\Theta \mid \Gamma, v : T \vdash \switch{v}{\bra{\overline{m_i \Gamma_i}}}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \begin{minipage}{0.45\textwidth}
    \begin{prooftree}
      \AxiomC{$\sig{T}{\ldots, m\ \Gamma, \ldots} \in \Theta$}
      \RightLabel{\textsc{Invoke}}
      \UnaryInfC{$\Theta \mid \Gamma, v \cnt T \vdash \invoke{v}{m}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \vspace{1em}

  \begin{minipage}{0.22\textwidth}
    \begin{prooftree}
      \AxiomC{\phantom{nothing}}
      \RightLabel{\textsc{Done}}
      \UnaryInfC{$\Theta \mid \Gamma \vdash \done$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \begin{minipage}{0.43\textwidth}
    \begin{prooftree}
      \AxiomC{$\Theta \mid v'_1 :^{p} \tau, \ldots \vdash s$}
      \AxiomC{$v_1 :^{p} \tau \in \Gamma \ldots$}
      \RightLabel{\textsc{Substitute}}
      \BinaryInfC{$\Theta \mid \Gamma \vdash \substitute{v'_1 \mapsto v_1, \ldots}{s}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \begin{minipage}{0.25\textwidth}
    \begin{prooftree}
      \AxiomC{$\mathbf{def}\ f\ \Gamma \in \Theta$}
      \RightLabel{\textsc{Jump}}
      \UnaryInfC{$\Theta \mid \Gamma \vdash \jump{f}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \vspace{1em}
\end{minipage}
\begin{minipage}{\textwidth}
  \vspace{1em}
  \judgementbox{Kinding Types}{$\Theta\vdash\tau:\kappa$}
  \begin{minipage}{0.4\textwidth}
    \begin{prooftree}
      \AxiomC{}
      \RightLabel{\textsc{PrimKind}}
      \UnaryInfC{$\Theta \vdash \tyint : \mathbf{prim}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \begin{minipage}{0.5\textwidth}
    \begin{prooftree}
      \AxiomC{$\sig{T}{\ldots} \in \Theta$}
      \RightLabel{\textsc{SignatureKind}}
      \UnaryInfC{$\Theta \vdash T : \mathbf{sign}$}
    \end{prooftree}
  \end{minipage}
  \vspace{1em}
\end{minipage}
\begin{minipage}{\textwidth}
  \vspace{1em}
  \judgementbox{Well-formed Programs}{$\vdash \wellformed{\Theta}$}
  \begin{minipage}{0.2\textwidth}
    \begin{prooftree}
      \AxiomC{}
      \RightLabel{\textsc{Wf-Empty}}
      \UnaryInfC{$\vdash \wellformed{\nil}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \begin{minipage}{0.75\textwidth}
    \begin{prooftree}
      \AxiomC{$\vdash \wellformed{\Theta}$}
      \AxiomC{$\overline{\Theta,\sig{T}{\dots}\vdash\goodctx{\Gamma_i}}$}
      \AxiomC{$\overline{ \Gamma_i \vdash \tau_i:\kappa}$}
      \RightLabel{\textsc{Wf-Signature}}
      \TrinaryInfC{$\vdash \wellformed{\Theta,\sig{T}{ \overline{m_i\ \Gamma_i}}}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \vspace{1em}

  \begin{minipage}{0.90\textwidth}
    \begin{prooftree}
      \AxiomC{$\vdash \wellformed{\Theta}$}
      \AxiomC{$\Theta, \defi{f : \Gamma}{s} \mid\Gamma \vdash s$}
      \RightLabel{\textsc{Wf-Def}}
      \BinaryInfC{$\vdash \wellformed{\Theta,\defi{f : \Gamma}{s}}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \vspace{1em}
\end{minipage}
\begin{minipage}{\textwidth}
  \vspace{1em}
  \judgementbox{Well-formed Contexts}{$\Theta\vdash \goodctx{\Gamma}$}
  \begin{minipage}{0.45\textwidth}
    \begin{prooftree}
      \AxiomC{\phantom{$x\in\nil$}}
      \RightLabel{\textsc{Ctx}$_1$}
      \UnaryInfC{$\Theta\vdash\goodctx{\nil}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \vspace{1em}
  \begin{minipage}{0.45\textwidth}
    \begin{prooftree}
      \AxiomC{$\Theta\vdash\goodctx{\Gamma} \quad v\notin\Gamma \quad \Theta\vdash\tau:\kappa$}
      \RightLabel{\textsc{Ctx}$_2$}
      \UnaryInfC{$\Theta\vdash\goodctx{\Gamma,v:\tau}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \vspace{1em}
  \begin{minipage}{0.45\textwidth}
    \begin{prooftree}
      \AxiomC{$\Theta\vdash\goodctx{\Gamma} \quad v\notin\Gamma \quad \Theta\vdash\tau:\kappa$}
      \RightLabel{\textsc{Ctx}$_3$}
      \UnaryInfC{$\Theta\vdash \goodctx{\Gamma,v\cnt\tau}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \vspace{1em}
  \begin{minipage}{0.45\textwidth}
    \begin{prooftree}
      \AxiomC{$\Theta\vdash\goodctx{\Gamma} \quad v\notin\Gamma \quad \Theta\vdash\tau:\kappa$}
      \RightLabel{\textsc{Ctx}$_4$}
      \UnaryInfC{$\Theta\vdash \goodctx{\Gamma,v\ext\tau}$}
    \end{prooftree}
  \end{minipage}
  \hfill
  \vspace{1em}
\end{minipage}
\caption{Typing rules for \machinelang{}}
\label{fig:axcut-rules}
\end{figure}
