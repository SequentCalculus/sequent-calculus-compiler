\begin{definition}[Syntax of \targetlang{}]
  \[
    \begin{array}{rcll}
      p & \coloneqq & x \mid \lit{n} \mid \mu\alpha.s \mid K\ \sigma \mid \cocase{\overline{D\ \Gamma \Rightarrow s}} & \emph{Producers}\\
      c & \coloneqq & \alpha \mid \tilde{\mu}x.s \mid D\ \sigma \mid \case{\overline{K\ \Gamma \Rightarrow s}}& \emph{Consumers}\\
      s & \coloneqq & \cut{p}{c} \mid \ifz{p}{s}{s} \mid \odot(p, p; c) \mid f\ \sigma\mid \done & \emph{Statements}\\
      \grey{\sigma} & \grey{\coloneqq} & \grey{\nil \mid \sigma, p \mid \sigma, c} & \emph{Substitutions}\\
      \grey{\tau} & \grey{\coloneqq} & \grey{\tyint \mid T} & \emph{Types}\\
      \grey{\kappa} & \grey{\coloneqq} & \grey{\mathbf{data}\mid\mathbf{codata}\mid\mathbf{prim}} & \emph{Kinds}\\
      \grey{\Gamma} & \grey{\coloneqq} & \grey{\emptyset \mid \Gamma, x : \tau \mid \Gamma, \alpha \cnt \tau} & \emph{Typing Contexts} \\
      \delta & \coloneqq & \grey{\mathbf{data}\ T\ \{ \overline{K\ \Gamma} \}} \mid \mathbf{codata}\ T\ \{ \overline{D\ \Gamma }\} \mid \defi{f\ \Gamma}{s} & \emph{Declarations}\\
      \grey{\Theta} & \grey{\coloneqq} & \grey{\overline{\delta}} & \emph{Programs}\\
    \end{array}
  \]
\end{definition}
The most important difference between the language Fun and the language \targetlang{} are the different syntactic categories.
While Fun only had terms, \targetlang{} has producers, consumers and statements. 
As a simple approximation, terms in Fun correspond to producers in \targetlang{}, consumers correspond to continuations and statements correspond to computations. 
In \cref{sec:translation} we will explain this in more detail.

%%
%% Subsec: Typing Rules
%%
\subsection{Typing Rules}
\label{subsec:core:typing-rules}

As before, there are a number of judgements used to type expressions in \targetlang{}. 
Most of them are analogous to Fun, but since we now have producers, consumers and statements instead of terms, the typing judgement for terms has been split into three different ones. 

\begin{figure}
  \begin{minipage}{\textwidth}
    \vspace{1em}
    \judgementbox{Typing Producers}{$\Theta\mid\Gamma\vdash p:\tau$}
    \vspace{1em}
    \hfill
    \begin{minipage}{0.45\textwidth}
      \begin{prooftree}
        \AxiomC{$\Theta\mid\Gamma,\alpha\cnt \tau \vdash s$}
        \RightLabel{\textsc{$\mu$}}
        \UnaryInfC{$\Theta\mid\Gamma \vdash \mu\alpha.s:\tau$}
      \end{prooftree}
    \end{minipage}
    \hfill
    \vspace{1em}
    \begin{minipage}{0.45\textwidth}
      \begin{prooftree}
        \AxiomC{$\mathbf{codata}\ T\ \{\overline{D_i\ \Gamma_i} \}\in\Gamma$}
        \AxiomC{$\overline{\Theta\mid\Gamma,\Gamma_i \vdash s_i}$}
        \RightLabel{\textsc{Cocase}}
        \BinaryInfC{$\Theta\mid\Gamma \vdash \mathbf{cocase}\ \{\overline{D_i\ \Gamma_i\Rightarrow s_i}\} : T $}
      \end{prooftree}
    \end{minipage}
    \hfill
    \vspace{1em}
    \center{The rules \textsc{Var}, \textsc{Constructor} and \textsc{Lit} are identical to the ones in \cref{fig:fun-rules}.}
    \vspace{1em}
  \end{minipage}

  \begin{minipage}{\textwidth}
    \judgementbox{Typing Consumers}{$\Theta\mid\Gamma\vdash c\cnt \tau$}

    \begin{minipage}{\textwidth}
      \begin{prooftree}
        \AxiomC{$\Theta\mid\Gamma,x:\tau \vdash s$}
        \RightLabel{\textsc{$\tilde{\mu}$}}
        \UnaryInfC{$\Theta\mid\Gamma \vdash \tilde{\mu}x.s \cnt \tau$}
      \end{prooftree}
    \end{minipage}
    \hfill
    \vspace{1em}

    \begin{minipage}{0.45\textwidth}
      \begin{prooftree}
        \AxiomC{$\mathbf{codata}\ \{D\ \Gamma^{\prime}, \dots\}\in\Gamma$}
        \AxiomC{$\Theta\mid\Gamma \vdash \sigma:\Gamma^{\prime}$}
        \RightLabel{\textsc{Destructor}}
        \BinaryInfC{$\Theta\mid\Gamma \vdash D\ \sigma \cnt T$}
      \end{prooftree}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
      \begin{prooftree}
        \AxiomC{$\mathbf{data}\ \{\overline{K_i\ \Gamma_i}\}\in\Gamma$}
        \AxiomC{$\overline{\Theta\mid\Gamma,\Gamma_i\vdash s_i}$}
        \RightLabel{\textsc{Case}}
        \BinaryInfC{$\Theta\mid\Gamma \vdash \mathbf{case}\ \{ \overline{K_i\ \Gamma_i\Rightarrow s_i}\}  \cnt T$}
      \end{prooftree}
    \end{minipage}
    \hfill
    \vspace{1em}
    \center{The rule \textsc{Var}$_2$ is identical to the one in \cref{fig:fun-rules}}
    \vspace{1em}
  \end{minipage}

  \begin{minipage}{\textwidth}
    \judgementbox{Well-Typed Statements}{$\Theta\mid\Gamma \vdash s$}

    \begin{minipage}{0.3\textwidth}
      \begin{prooftree}
        \AxiomC{$\Theta\mid\Gamma \vdash p :\tau$}
        \AxiomC{$\Theta\mid\Gamma \vdash c \cnt \tau$}
        \RightLabel{\textsc{Cut}}
        \BinaryInfC{$\Theta\mid\Gamma \vdash \cut{p}{c}$}
      \end{prooftree}
    \end{minipage}
    \hfill
    \begin{minipage}{0.4\textwidth}
      \begin{prooftree}
        \AxiomC{$\Theta\mid\Gamma \vdash p : \tyint$}
        \AxiomC{$\Theta\mid\Gamma \vdash s_1$}
        \AxiomC{$\Theta\mid\Gamma \vdash s_2$}
        \RightLabel{\textsc{IfZ}}
        \TrinaryInfC{$\Theta\mid\Gamma \vdash \ifz{p}{s_1}{s_2}$}
      \end{prooftree}
    \end{minipage}
    \hfill
    \begin{minipage}{0.2\textwidth}
      \begin{prooftree}
        \AxiomC{\phantom{nothing}}
        \RightLabel{\textsc{Done}}
        \UnaryInfC{$\nil\mid\Gamma \vdash\mathbf{done}$}
      \end{prooftree}
    \end{minipage}
    \hfill
    \vspace{1em}

    \begin{minipage}{0.6\textwidth}
      \begin{prooftree}
        \AxiomC{$\Theta\mid\Gamma \vdash p_1 : \tyint$}
        \AxiomC{$\Theta\mid\Gamma \vdash p_2 : \tyint$}
        \AxiomC{$\Theta\mid\Gamma \vdash c \cnt \tyint$}
        \RightLabel{\textsc{binop}}
        \TrinaryInfC{$\Theta\mid\Gamma \vdash \odot(p_1,p_2;c)$}
      \end{prooftree}
    \end{minipage}
    \hfill
    \begin{minipage}{0.3\textwidth}
      \begin{prooftree}
        \AxiomC{$\mathbf{def}\ f\ \Gamma^{\prime} \in \Theta$}
        \AxiomC{$\Theta\mid\Gamma \vdash \sigma : \Gamma^{\prime}$}
        \RightLabel{\textsc{Call}}
        \BinaryInfC{$\Theta\mid\Gamma \vdash f\ \sigma$}
      \end{prooftree}
    \end{minipage}
    \hfill
    \vspace{1em}
  \end{minipage}

  \begin{minipage}{\textwidth}
    \judgementbox{Well-formed Programs}{$\vdash \wellformed{\Theta}$}
 
    \begin{minipage}{0.55\textwidth}
      \begin{prooftree}
        \AxiomC{$\vdash \wellformed{\Theta}$}
        \AxiomC{$\overline{\Theta,\mathbf{codata}\ T\ \{\dots\} \vdash\goodctx{\Gamma_i}}$}
        \RightLabel{\textsc{Wf-Codata}}
        \BinaryInfC{$\vdash \wellformed{\Theta,\mathbf{codata}\ T\ \{ \overline{D_i\ \Gamma_i : \tau}\}}$}
      \end{prooftree}
    \end{minipage}
    \hfill
    \begin{minipage}{0.4\textwidth}
      \begin{prooftree}
        \AxiomC{$\vdash \wellformed{\Theta}$}
        \AxiomC{$\Theta,\mathbf{def}\ f\ \Gamma \coloneq s\mid\Gamma \vdash s$}
        \RightLabel{\textsc{Wf-Fun}}
        \BinaryInfC{$\vdash \wellformed{\Theta,\mathbf{def}\ \text{f}\ \Gamma \coloneq s}$}
      \end{prooftree}
    \end{minipage}
    \hfill
    \vspace{1em}
    \center{The rules \textsc{Wf-Data} and \textsc{Wf-Empty} are identical to the ones in \cref{fig:fun-rules}}
    \vspace{1em}
  \end{minipage}
  \begin{minipage}{\textwidth}
    \fbox{\begin{minipage}{0.3\textwidth}
      \makebox[\textwidth][c]{$\Theta\mid\Gamma\vdash \sigma:\Gamma^{\prime}$ identical to \cref{fig:fun-rules}}
    \end{minipage}}
    \hfill
    \fbox{\begin{minipage}{0.3\textwidth}
      \makebox[\textwidth][c]{$\Theta\mid\Gamma\vdash \tau:\kappa$ identical to \cref{fig:fun-rules}}
    \end{minipage}}
    \hfill
    \fbox{\begin{minipage}{0.3\textwidth}
      \makebox[\textwidth][c]{{$\Theta\vdash \goodctx{\Gamma}$ identical to\cref{fig:fun-rules}}}
    \end{minipage}}
  \end{minipage}
  \caption{Typing Rules for \targetlang{}}
\end{figure}
